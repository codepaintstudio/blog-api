# Blog API 产品设计文档

## 1. 项目概述

### 1.1 项目目标

搭建一套免费的 Blog API 服务，主要面向前端开发学习者，通过提供完整的博客后端接口，帮助前端开发者练习和提升开发技能。

### 1.2 目标用户

- **主要用户**：前端开发学习者、学生、初级开发者
- **系统管理员**：项目维护团队

## 2. 用户角色定义

### 2.1 系统管理员 (sys-admin)

- **身份**：系统维护者和管理者
- **职责**：
  - 系统运维和监控
  - 用户数据管理和维护
  - 系统配置和安全策略管理
  - 异常用户行为处理

### 2.2 普通用户 (user)

- **身份**：前端开发学习者
- **职责**：
  - 创建和管理个人博客内容
  - 学习和实践前端开发技能

## 3. 功能需求

### 3.1 用户管理模块

#### 3.1.1 用户注册

- 支持邮箱注册
- 用户名唯一性验证
- 密码强度要求
- 邮箱验证机制

#### 3.1.2 用户登录

- 邮箱/用户名登录
- JWT Token 认证
- 登录失败次数限制
- 记住登录状态

#### 3.1.3 用户资料管理

- 修改基本信息（昵称、简介、邮箱等）
- 头像上传和修改
- 密码修改
- 账号注销

### 3.2 文章管理模块

#### 3.2.1 文章发布

- **基本信息**：
  - 标题
  - 内容（支持 Markdown）
  - 描述/摘要
  - 封面图片
  - 发布时间
  - 更新时间

#### 3.2.2 文章分类

- 用户自定义分类
- 分类的增删改查
- 文章与分类的关联

#### 3.2.3 文章管理

- 草稿/发布状态切换
- 可见性控制（公开/私有）
- 文章编辑和删除
- 文章列表查看

#### 3.2.4 文章公开浏览

- 公开文章列表展示
- 文章详情页面
- 浏览量统计和展示
- 按分类筛选文章
- 文章搜索功能
- 文章排序（最新、最热、浏览量、点赞数）

#### 3.2.5 文章互动功能

- **文章点赞**：

  - 用户可以对文章点赞/取消点赞
  - 点赞数统计和展示
  - 每个用户对每篇文章只能点赞一次
  - 支持游客查看点赞数，但不能点赞

- **文章收藏**：
  - 用户可以收藏喜欢的文章
  - 收藏夹功能，用户可以创建多个收藏夹
  - 收藏数统计和展示
  - 收藏列表管理（查看、删除收藏）
  - 支持收藏分类整理

### 3.3 用户个人中心模块

#### 3.3.1 我的收藏

- 查看收藏的文章列表
- 按收藏夹分类查看
- 收藏夹管理（创建、重命名、删除）
- 收藏文章的搜索和排序
- 批量管理收藏

#### 3.3.2 我的点赞

- 查看点赞过的文章列表
- 按时间排序查看点赞历史
- 取消点赞功能

### 3.4 分类管理模块

- 创建自定义分类
- 分类名称和描述
- 分类的增删改查
- 分类下文章统计

### 3.5 评论互动模块

#### 3.4.1 评论功能

- 文章评论发布
- 评论列表展示
- 评论回复功能（支持多级回复）
- 评论点赞功能
- 评论举报功能

#### 3.4.2 评论管理

- 用户管理自己的评论
- 文章作者管理文章评论
- 评论删除功能
- 评论审核机制

### 3.6 系统管理模块

#### 3.6.1 用户管理

- 查看所有用户信息
- 用户状态管理（启用/禁用）
- 用户数据统计
- 异常用户处理

#### 3.6.2 内容管理

- 查看所有文章内容
- 内容审核和管理
- 违规内容处理
- 内容统计分析

#### 3.6.3 评论管理

- 查看所有评论内容
- 评论审核和管理
- 违规评论处理
- 评论统计分析

## 4. 非功能性需求

### 4.1 性能需求

- API 响应时间 < 500ms
- 支持并发用户数：1000+
- 文件上传大小限制：10MB

### 4.2 安全需求

- 接口防刷机制
- 用户认证和授权
- 数据加密存储
- SQL 注入防护
- XSS 攻击防护

### 4.3 可用性需求

- 系统可用性 99%+
- 友好的错误提示
- 完善的 API 文档
- 规范的 HTTP 状态码

## 5. 数据模型

### 5.1 用户表 (users)

```
- id: 用户ID
- username: 用户名
- email: 邮箱
- password: 密码（加密）
- nickname: 昵称
- avatar: 头像URL
- bio: 个人简介
- role: 角色（admin/user）
- status: 状态（active/inactive）
- created_at: 创建时间
- updated_at: 更新时间
```

### 5.2 文章表 (articles)

```
- id: 文章ID
- user_id: 作者ID
- title: 标题
- content: 内容
- description: 描述
- cover_image: 封面图片URL
- category_id: 分类ID
- status: 状态（draft/published）
- visibility: 可见性（public/private）
- view_count: 阅读量
- created_at: 创建时间
- updated_at: 更新时间
```

### 5.3 分类表 (categories)

```
- id: 分类ID
- user_id: 用户ID
- name: 分类名称
- description: 分类描述
- created_at: 创建时间
- updated_at: 更新时间
```

### 5.4 评论表 (comments)

```
- id: 评论ID
- article_id: 文章ID
- user_id: 评论用户ID
- parent_id: 父评论ID（用于回复功能，顶级评论为NULL）
- content: 评论内容
- like_count: 点赞数
- status: 状态（published/hidden/deleted）
- created_at: 创建时间
- updated_at: 更新时间
```

### 5.5 评论点赞表 (comment_likes)

```
- id: 点赞ID
- comment_id: 评论ID
- user_id: 点赞用户ID
- created_at: 创建时间
```

### 5.6 文章点赞表 (article_likes)

```
- id: 点赞ID
- article_id: 文章ID
- user_id: 点赞用户ID
- created_at: 创建时间
```

### 5.7 收藏夹表 (favorite_folders)

```
- id: 收藏夹ID
- user_id: 用户ID
- name: 收藏夹名称
- description: 收藏夹描述
- is_default: 是否默认收藏夹
- created_at: 创建时间
- updated_at: 更新时间
```

### 5.8 文章收藏表 (article_favorites)

```
- id: 收藏ID
- article_id: 文章ID
- user_id: 用户ID
- folder_id: 收藏夹ID
- created_at: 收藏旷间
```

## 6. 业务规则

### 6.1 用户规则

- 每个用户只能管理自己的内容
- 用户名和邮箱全局唯一
- 管理员可以查看所有用户数据

### 6.2 文章规则

- 文章只有作者可以编辑
- 私有文章仅作者可见
- 草稿状态文章不对外展示
- 管理员可以管理所有文章

### 6.3 分类规则

- 分类由用户自行创建和管理
- 分类删除时需处理关联文章
- 每个用户的分类名称不可重复

### 6.4 文章浏览规则

- 公开文章所有人可见
- 私有文章仅作者可见
- 文章浏览量实时更新
- 支持游客浏览（无需登录）

### 6.5 评论规则

- 评论需要登录后才能发布
- 用户只能删除自己的评论
- 文章作者可以删除文章下的任何评论
- 管理员可以管理所有评论
- 评论支持多级回复（最多 3 级）
- 每个用户对每条评论只能点赞一次

### 6.6 文章互动规则

- **点赞规则**：

  - 点赞需要登录后才能操作
  - 每个用户对每篇文章只能点赞一次
  - 用户可以取消自己的点赞
  - 文章作者不能对自己的文章点赞

- **收藏规则**：
  - 收藏需要登录后才能操作
  - 用户可以收藏任何公开文章（包括自己的）
  - 每个用户默认有一个“默认收藏夹”
  - 用户可以创建多个收藏夹进行分类管理
  - 收藏夹名称在用户下不可重复

## 7. API 设计原则

### 7.1 RESTful 风格

- 使用标准 HTTP 方法
- 资源导向的 URL 设计
- 统一的响应格式

### 7.2 安全原则

- 所有接口需要适当的权限验证
- 敏感操作需要额外验证
- 实现接口限流和防刷

### 7.3 可扩展性

- 预留扩展字段
- 版本化 API 设计
- 模块化架构设计

## 8. 项目里程碑

### 8.1 第一阶段：基础功能

- 用户注册登录
- 基本文章 CRUD
- 基础分类管理
- 文章公开浏览功能
- 文章点赞功能

### 8.2 第二阶段：完善功能

- 文章可见性控制
- 头像上传
- 文章收藏功能
- 评论系统
- 系统管理功能

### 8.3 第三阶段：优化增强

- 评论点赞和多级回复
- 收藏夹分类管理
- 文章搜索和排序
- 个人中心完善功能
- 性能优化
- 安全加固
- API 文档完善
